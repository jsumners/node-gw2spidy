<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: src/components/spidyClient.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: src/components/spidyClient.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

var http = require('http');

var server = 'www.gw2spidy.com',
    basePath = '/api/v0.9/json/';

var client404 = new Error('GW2 Spidy returned a 404');

/**
 * An interface for getting data from the GW2 Spidy REST API. You shouldn't
 * need to use this interface directly. The {@link Gw2SpidyClient} provides
 * a higher level interface that is easier to use.
 *
 * @returns {SpidyClient}
 * @constructor
 */
function SpidyClient() {
  if (! (this instanceof SpidyClient)) {
    return new SpidyClient();
  }
}

/**
 * This callback is invoked when a GET request to the GW2 Spidy REST API has
 * completed.
 *
 * @callback SpidyClient~RestGetCallback
 * @param {Error} err An error object or null (no error)
 * @param {string} json A string of JSON that represents the result
 */

/**
 * Attempts to retrieve JSON data from a specified endpoint, e.g. `/types`.
 *
 * @param {string} endpoint An endpoint on the GW2 Spidy API
 * @param {SpidyClient~RestGetCallback} cb The callback to invoke when done
 */
SpidyClient.prototype.get = function restGet(endpoint, cb) {
  var _endpoint = (endpoint.charAt(0) === '/') ? endpoint.substr(1) : endpoint;
  var httpOptions = {
    host: server,
    path: basePath + _endpoint
  };

  var request = http.request(httpOptions, function requestCB(response) {
    if (response.status === 404) {
      cb(client404);
      return;
    }

    var data = '';
    response.on('data', function dataCB(chunk) {
      data += chunk;
    });

    response.on('error', function erroCB(err) {
      cb(err);
    });

    response.on('end', function endCB() {
      cb(null, data.toString());
    });
  });

  request.on('error', function requestErrorCB(err) {
    cb(err);
  });

  request.end();
};

exports = module.exports = function() {
  return new SpidyClient();
};

exports['@singleton'] = true;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="Disciplines.html">Disciplines</a></li><li><a href="DisciplinesResponse.html">DisciplinesResponse</a></li><li><a href="Gw2SpidyClient.html">Gw2SpidyClient</a></li><li><a href="ItemDataResponse.html">ItemDataResponse</a></li><li><a href="ItemListingsResponse.html">ItemListingsResponse</a></li><li><a href="ItemListResponse.html">ItemListResponse</a></li><li><a href="Items.html">Items</a></li><li><a href="Rarities.html">Rarities</a></li><li><a href="RarityListResponse.html">RarityListResponse</a></li><li><a href="SpidyClient.html">SpidyClient</a></li><li><a href="TypeListResponse.html">TypeListResponse</a></li><li><a href="Types.html">Types</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha10</a> on Wed Nov 26 2014 20:00:12 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
